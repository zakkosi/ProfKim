{
  "doc_id": "pages_495_497",
  "text": "10.1 Photometric calibration\n473\nmeasured pixel values. The vignetting and noise characteristics of the camera can also be\nsimultaneously determined.\nA more practical alternative is to use a calibration chart (Figure 10.3b) such as the Mac-\nbeth or Munsell ColorChecker Chart.8 The biggest problem with this approach is to ensure\nuniform lighting. One approach is to use a large dark room with a high-quality light source\nfar away from (and perpendicular to) the chart. Another is to place the chart outdoors away\nfrom any shadows. (The results will differ under these two conditions, because the color of\nthe illuminant will be different).\nThe easiest approach is probably to take multiple exposures of the same scene while the\ncamera is on a tripod and to recover the response function by simultaneously estimating the\nincoming irradiance at each pixel and the response curve (Mann and Picard 1995; Debevec\nand Malik 1997; Mitsunaga and Nayar 1999). This approach is discussed in more detail in\nSection 10.2 on high dynamic range imaging.\nIf all else fails, i.e., you just have one or more unrelated photos, you can use an Interna-\ntional Color Consortium (ICC) proﬁle for the camera (Fairchild 2005).9 Even more simply,\nyou can just assume that the response is linear if they are RAW ﬁles and that the images have\na γ = 2.2 non-linearity (plus clipping) applied to each RGB channel if they are JPEG images.\n10.1.2 Noise level estimation\nIn addition to knowing the camera response function, it is also often important to know the\namount of noise being injected under a particular camera setting (e.g., ISO/gain level). The\nsimplest characterization of noise is a single standard deviation, usually measured in gray\nlevels, independent of pixel value. A more accurate model can be obtained by estimating\nthe noise level as a function of pixel value (Figure 10.4), which is known as the noise level\nfunction (Liu, Szeliski, Kang et al. 2008).\nAs with the camera response function, the simplest way to estimate these quantities is in\nthe lab, using either an integrating sphere or a calibration chart. The noise can be estimated\neither at each pixel independently, by taking repeated exposures and computing the temporal\nvariance in the measurements (Healey and Kondepudy 1994), or over regions, by assuming\nthat pixel values should all be the same within some region (e.g., inside a color checker\nsquare) and computing a spatial variance.\nThis approach can be generalized to photos where there are regions of constant or slowly\nvarying intensity (Liu, Szeliski, Kang et al. 2008). First, segment the image into such regions\nand ﬁt a constant or linear function inside each region. Next, measure the (spatial) standard\ndeviation of the differences between the noisy input pixels and the smooth ﬁtted function\n8 http://www.xrite.com.\n9 See also the ICC Information on Proﬁles, http://www.color.org/info proﬁles2.xalter.\n474\nComputer Vision: Algorithms and Applications (September 3, 2010 draft)\nFigure 10.4\nNoise level function estimates obtained from a single color photograph (Liu,\nSzeliski, Kang et al. 2008) c⃝2008 IEEE. The colored curves are the estimated NLF ﬁt as the\nprobabilistic lower envelope of the measured deviations between the noisy piecewise-smooth\nimages. The ground truth NLFs obtained by averaging 29 images are shown in gray.\naway from large gradients and region boundaries. Plot these as a function of output level for\neach color channel, as shown in Figure 10.4. Finally, ﬁt a lower envelope to this distribution\nin order to ignore pixels or deviations that are outliers. A fully Bayesian approach to this\nproblem that models the statistical distribution of each quantity is presented by (Liu, Szeliski,\nKang et al. 2008). A simpler approach, which should produce useful results in most cases,\nis to ﬁt a low-dimensional function (e.g., positive valued B-spline) to the lower envelope (see\nExercise 10.2).\nIn more recent work, Matsushita and Lin (2007) present a technique for simultaneously\nestimating a camera’s response and noise level functions based on skew (asymmetries) in\nlevel-dependent noise distributions. Their paper also contains extensive references to previ-\nous work in these areas.\n10.1.3 Vignetting\nA common problem with using wide-angle and wide-aperture lenses is that the image tends\nto darken in the corners (Figure 10.5a). This problem is generally known as vignetting and\ncomes in several different forms, including natural, optical, and mechanical vignetting (Sec-\ntion 2.2.3) (Ray 2002). As with radiometric response function calibration, the most accurate\nway to calibrate vignetting is to use an integrating sphere or a picture of a uniformly colored\nand illuminated blank wall.\nAn alternative approach is to stitch a panoramic scene and to assume that the true radiance\nat each pixel comes from the central portion of each input image. This is easier to do if\nthe radiometric response function is already known (e.g., by shooting in RAW mode) and\nif the exposure is kept constant. If the response function, image exposures, and vignetting\nfunction are unknown, they can still be recovered by optimizing a large least squares ﬁtting\n10.1 Photometric calibration\n475\nFigure 10.5\nSingle image vignetting correction (Zheng, Yu, Kang et al. 2008) c⃝2008\nIEEE: (a) original image with strong visible vignetting; (b) vignetting compensation as de-\nscribed by Zheng, Zhou, Georgescu et al. (2006); (c–d) vignetting compensation as described\nby Zheng, Yu, Kang et al. (2008).\n(a)\n(b)\n(c)\n(d)\nFigure 10.6\nSimultaneous estimation of vignetting, exposure, and radiometric response\n(Goldman 2011) c⃝2011 IEEE: (a) original average of the input images; (b) after compen-\nsating for vignetting; (c) using gradient domain blending only (note the remaining mottled\nlook); (d) after both vignetting compensation and blending.\nproblem (Litvinov and Schechner 2005; Goldman 2011). Figure 10.6 shows an example of\nsimultaneously estimating the vignetting, exposure, and radiometric response function from\na set of overlapping photographs (Goldman 2011). Note that unless vignetting is modeled\nand compensated, regular gradient-domain image blending (Section 9.3.4) will not create an\nattractive image.\nIf only a single image is available, vignetting can be estimated by looking for slow con-\nsistent intensity variations in the radial direction. The original algorithm proposed by Zheng,\nLin, and Kang (2006) ﬁrst pre-segmented the image into smoothly varying regions and then\nperformed an analysis inside each region. Instead of pre-segmenting the image, Zheng, Yu,\nKang et al. (2008) compute the radial gradients at all the pixels and use the asymmetry in\nthis distribution (since gradients away from the center are, on average, slightly negative) to",
  "image_path": "page_496.jpg",
  "pages": [
    495,
    496,
    497
  ]
}