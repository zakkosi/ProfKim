{
  "doc_id": "pages_387_389",
  "text": "7.4 Bundle adjustment\n365\npi\nw\npi\nr\n(Rt\nr,ct\nr)\n(Rj\nc,cj\nc)\nY\nX\n(a)\nfR(x)\n= Rj\ncx\nqj\nc\nfT(x)\n= x-cj\nc\ncj\nc\ny(1)\ny(2)\nfR(x)\n= Rt\nrx\nqt\nr\nfT(x)\n= x-ct\nr\nct\nr\npi\nw\ny(0)\npi\nr\n…\n(b)\nFigure 7.8\nA camera rig and its associated transform chain. (a) As the mobile rig (robot)\nmoves around in the world, its pose with respect to the world at time t is captured by (Rr\nt, cr\nt).\nEach camera’s pose with respect to the rig is captured by (Rc\nj, cc\nj). (b) A 3D point with world\ncoordinates pw\ni is ﬁrst transformed into rig coordinates pr\ni, and then through the rest of the\ncamera-speciﬁc chain, as shown in Figure 7.7.\nA\nB\nC\nD\n1\n2\n3\n4\n5\n6\n7\n8\n9\n1\n2\n3\n4\n5\n6\n7\n8\n9\nA\nB\nC\nD\n1A\n1B\n2A\n2B\n3A\n3B\n4A\n4B\n4C\n5B\n5C\n6B\n6C\n7C\n7D\n8C\n8D\n9C\n9D\n1\n2\n3\n4\n5\n6\n7\n8\n9\nA\nB\nC\nD\n1\n2\n3\n4\n5\n6\n7\n8\n9\nA\nB\nC\nD\n(a)\n(b)\n(c)\nFigure 7.9\n(a) Bipartite graph for a toy structure from motion problem and (b) its associated\nJacobian J and (c) Hessian A. Numbers indicate 3D points and letters indicate cameras. The\ndashed arcs and light blue squares indicate the ﬁll-in that occurs when the structure (point)\nvariables are eliminated.\n366\nComputer Vision: Algorithms and Applications (September 3, 2010 draft)\nIf we order the structure variables before the motion variables in the Hessian matrix A\n(and hence also the right hand side vector b), we obtain a structure for the Hessian shown in\nFigure 7.9c.14 When such a system is solved using sparse Cholesky factorization (see Ap-\npendix A.4) (Bj¨orck 1996; Golub and Van Loan 1996), the ﬁll-in occurs in the smaller motion\nHessian Acc (Szeliski and Kang 1994; Triggs, McLauchlan, Hartley et al. 1999; Hartley and\nZisserman 2004; Lourakis and Argyros 2009; Engels, Stew´enius, and Nist´er 2006). Some re-\ncent papers by (Byr¨od and øAstr¨om 2009), Jeong, Nist´er, Steedly et al. (2010) and (Agarwal,\nSnavely, Seitz et al. 2010) explore the use of iterative (conjugate gradient) techniques for the\nsolution of bundle adjustment problems.\nIn more detail, the reduced motion Hessian is computed using the Schur complement,\nA′\ncc = Acc −AT\npcA−1\npp Apc,\n(7.56)\nwhere App is the point (structure) Hessian (the top left block of Figure 7.9c), Apc is the\npoint-camera Hessian (the top right block), and Acc and A′\ncc are the motion Hessians before\nand after the point variable elimination (the bottom right block of Figure 7.9c). Notice that\nA′\ncc has a non-zero entry between two cameras if they see any 3D point in common. This is\nindicated with dashed arcs in Figure 7.9a and light blue squares in Figure 7.9c.\nWhenever there are global parameters present in the reconstruction algorithm, such as\ncamera intrinsics that are common to all of the cameras, or camera rig calibration parameters\nsuch as those shown in Figure 7.8, they should be ordered last (placed along the right and\nbottom edges of A) in order to reduce ﬁll-in.\nEngels, Stew´enius, and Nist´er (2006) provide a nice recipe for sparse bundle adjustment,\nincluding all the steps needed to initialize the iterations, as well as typical computation times\nfor a system that uses a ﬁxed number of backward-looking frames in a real-time setting. They\nalso recommend using homogeneous coordinates for the structure parameters pi, which is a\ngood idea, since it avoids numerical instabilities for points near inﬁnity.\nBundle adjustment is now the standard method of choice for most structure-from-motion\nproblems and is commonly applied to problems with hundreds of weakly calibrated images\nand tens of thousands of points, e.g., in systems such as Photosynth. (Much larger prob-\nlems are commonly solved in photogrammetry and aerial imagery, but these are usually care-\nfully calibrated and make use of surveyed ground control points.) However, as the problems\nbecome larger, it becomes impractical to re-solve full bundle adjustment problems at each\niteration.\nOne approach to dealing with this problem is to use an incremental algorithm, where new\ncameras are added over time. (This makes particular sense if the data is being acquired from\n14 This ordering is preferable when there are fewer cameras than 3D points, which is the usual case. The exception\nis when we are tracking a small number of points through many video frames, in which case this ordering should be\nreversed.\n7.4 Bundle adjustment\n367\na video camera or moving vehicle (Nist´er, Naroditsky, and Bergen 2006; Pollefeys, Nist´er,\nFrahm et al. 2008).) A Kalman ﬁlter can be used to incrementally update estimates as new\ninformation is acquired. Unfortunately, such sequential updating is only statistically optimal\nfor linear least squares problems.\nFor non-linear problems such as structure from motion, an extended Kalman ﬁlter, which\nlinearizes measurement and update equations around the current estimate, needs to be used\n(Gelb 1974; Vi´eville and Faugeras 1990). To overcome this limitation, several passes can\nbe made through the data (Azarbayejani and Pentland 1995). Because points disappear from\nview (and old cameras become irrelevant), a variable state dimension ﬁlter (VSDF) can be\nused to adjust the set of state variables over time, for example, by keeping only cameras and\npoint tracks seen in the last k frames (McLauchlan 2000). A more ﬂexible approach to using\na ﬁxed number of frames is to propagate corrections backwards through points and cameras\nuntil the changes on parameters are below a threshold (Steedly and Essa 2001). Variants of\nthese techniques, including methods that use a ﬁxed window for bundle adjustment (Engels,\nStew´enius, and Nist´er 2006) or select keyframes for doing full bundle adjustment (Klein and\nMurray 2008) are now commonly used in real-time tracking and augmented-reality applica-\ntions, as discussed in Section 7.4.2.\nWhen maximum accuracy is required, it is still preferable to perform a full bundle ad-\njustment over all the frames. In order to control the resulting computational complexity, one\napproach is to lock together subsets of frames into locally rigid conﬁgurations and to optimize\nthe relative positions of these cluster (Steedly, Essa, and Dellaert 2003). A different approach\nis to select a smaller number of frames to form a skeletal set that still spans the whole dataset\nand produces reconstructions of comparable accuracy (Snavely, Seitz, and Szeliski 2008b).\nWe describe this latter technique in more detail in Section 7.4.4, where we discuss applica-\ntions of structure from motion to large image sets.\nWhile bundle adjustment and other robust non-linear least squares techniques are the\nmethods of choice for most structure-from-motion problems, they suffer from initialization\nproblems, i.e., they can get stuck in local energy minima if not started sufﬁciently close\nto the global optimum. Many systems try to mitigate this by being conservative in what\nreconstruction they perform early on and which cameras and points they add to the solution\n(Section 7.4.4). An alternative, however, is to re-formulate the problem using a norm that\nsupports the computation of global optima.\nKahl and Hartley (2008) describe techniques for using L∞norms in geometric recon-\nstruction problems. The advantage of such norms is that globally optimal solutions can be\nefﬁciently computed using second-order cone programming (SOCP). The disadvantage is that\nL∞norms are particularly sensitive to outliers and so must be combined with good outlier\nrejection techniques before they can be used.",
  "image_path": "page_388.jpg",
  "pages": [
    387,
    388,
    389
  ]
}