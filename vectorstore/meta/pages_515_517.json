{
  "doc_id": "pages_515_517",
  "text": "10.2 High dynamic range imaging\n493\n(a)\n(b)\nFigure 10.26\nGradient domain tone mapping (Fattal, Lischinski, and Werman 2002) c⃝\n2002 ACM: (a) attenuation map, with darker values corresponding to more attenuation; (b)\nﬁnal tone-mapped image.\nsimilar color values within the inner circle while avoiding much brighter values in the sur-\nrounding circle. In practice, a difference of Gaussians normalized by the inner Gaussian\nresponse is evaluated over a range of scales, and the largest scale whose metric is below a\nthreshold is selected (Reinhard, Stark, Shirley et al. 2002).\nWhat all of these techniques have in common is that they adaptively attenuate or brighten\ndifferent regions of the image so that they can be displayed in a limited gamut without loss of\ncontrast. Lischinski, Farbman, Uyttendaele et al. (2006b) introduce an interactive technique\nthat performs this operation by interpolating a set of sparse user-drawn adjustments (strokes\nand associated exposure value corrections) to a piecewise-continuous exposure correction\nmap (Figure 10.28). The interpolation is performed by minimizing a locally weighted least\nsquare (WLS) variational problem,\nmin\nZ Z\nwd(x, y)∥f(x, y) −g(x, y)∥2dx dy + λ\nZ Z\nws(x, y)∥∇f(x, y)∥2dx dy,\n(10.21)\nwhere g(x, y) and f(x, y) are the input and output log exposure (attenuation) maps (Fig-\nure 10.28). The data weighting term wd(x, y) is 1 at stroke locations and 0 elsewhere. The\nsmoothness weighting term ws(x, y) is inversely proportional to the log-luminance gradient,\nws =\n1\n∥∇H∥α + ϵ\n(10.22)\nand hence encourages the f(x, y) map to be smoother in low-gradient areas than along high-\ngradient discontinuities.14 The same approach can also be used for fully automated tone map-\n14 In practice, the x and y discrete derivatives are weighted separately (Lischinski, Farbman, Uyttendaele et al.\n494\nComputer Vision: Algorithms and Applications (September 3, 2010 draft)\nFigure 10.27\nScale selection for tone mapping (Reinhard, Stark, Shirley et al. 2002) c⃝\n2002 ACM.\nping by setting target exposure values at each pixel and allowing the weighted least squares\nto convert these into piecewise smooth adjustment maps.\nThe weighted least squares algorithm, which was originally developed for image coloriza-\ntion applications (Levin, Lischinski, and Weiss 2004), has recently been applied to general\nedge-preserving smoothing in applications such as contrast enhancement (Bae, Paris, and\nDurand 2006) and tone mapping (Farbman, Fattal, Lischinski et al. 2008) where the bilateral\nﬁltering was previously used. It can also be used to perform HDR merging and tone mapping\nsimultaneously (Raman and Chaudhuri 2007, 2009).\nGiven the wide range of locally adaptive tone mapping algorithms that have been devel-\noped, which ones should be used in practice? Freeman (2008) provides a great discussion\nof commercially available algorithms, their artifacts, and the parameters that can be used to\ncontrol them. He also has a wealth of tips for HDR photography and workﬂow. I highly rec-\nommend his book for anyone contemplating additional research (or personal photography) in\nthis area.\n10.2.2 Application: Flash photography\nWhile high dynamic range imaging combines images of a scene taken at different exposures,\nit is also possible to combine ﬂash and non-ﬂash images to achieve better exposure and color\nbalance and to reduce noise (Eisemann and Durand 2004; Petschnigg, Agrawala, Hoppe et\nal. 2004).\nThe problem with ﬂash images is that the color is often unnatural (it fails to capture the\nambient illumination), there may be strong shadows or specularities, and there is a radial\nfalloff in brightness away from the camera (Figures 10.1b and 10.29a). Non-ﬂash photos\n2006b). Their default parameter settings are λ = 0.2, α = 1, and ϵ = 0.0001.\n10.2 High dynamic range imaging\n495\n(a)\n(b)\nFigure 10.28 Interactive local tone mapping (Lischinski, Farbman, Uyttendaele et al. 2006b)\nc⃝2006 ACM: (a) user-drawn strokes with associated exposure values g(x, y) (b) correspond-\ning piecewise-smooth exposure adjustment map f(x, y).\n(a)\n(b)\n(c)\n(d)\nFigure 10.29 Detail transfer in ﬂash/no-ﬂash photography (Petschnigg, Agrawala, Hoppe et\nal. 2004) c⃝2004 ACM: (a) details of input ambient A and ﬂash F images; (b) joint bilaterally\nﬁltered no-ﬂash image ANR; (c) detail layer F Detail computed from the ﬂash image F; (d)\nﬁnal merged image AFinal.",
  "image_path": "page_516.jpg",
  "pages": [
    515,
    516,
    517
  ]
}